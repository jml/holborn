{ pkgs, stdenv, git, nodejs-4_x }:
#  Notes:
#  * This still caches in HOME, can't find out how to disable so we
#    store in a temporary directory which is cleaned up after the build.
#  * This connects NPM to the internet which is sad but
#    packaging NPM for nix is even sadder :(
stdenv.mkDerivation {
  name = "holborn-ui-node-from-the-internets";
  src = builtins.filterSource (path: type: baseNameOf path == "package.json") ../holborn-ui;
  phases = "unpackPhase installPhase";
  buildInputs = [ nodejs-4_x git ];
  installPhase = ''
    mkdir ./npm-home
    mkdir -p $out
    export HOME=$(readlink -f ./npm-home)  # For .npm/cache. Will be discarded.
    cp ./package.json $out/
    cd $out
    npm install
  '';
}
